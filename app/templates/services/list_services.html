{% extends "_base_page.html" %}
{% import "toolkit/summary-table.html" as summary %}

{% block page_title %}Current services â€“ Digital Marketplace{% endblock %}

{% block breadcrumb %}
  {%
    with items = [
      {
        "link": "/",
        "label": "Digital Marketplace"
      },
      {
        "link": url_for(".dashboard"),
        "label": "Your account"
      }
    ]
  %}
    {% include "toolkit/breadcrumb.html" %}
  {% endwith %}
{% endblock %}

{% block main_content %}
  {% if updated_service_id %}
    <div class="grid-row">
    <div class="column-one-whole">
      <div class="banner-success-without-action">
        <p class="banner-message">
          <a href="{{ url_for('.update_service_status', service_id=updated_service_id ) }}">{{ updated_service_name }}</a>
           is now {{ 'public' if updated_service_status == 'published' else 'private' }}
        </p>
      </div>
    </div>
    </div>
  {% endif %}
  <div class="grid-row">
    <div class="column-two-thirds">
      {% with
        heading = "Current services"
      %}
        {% include 'toolkit/page-heading.html' %}
      {% endwith %}
    </div>
  </div>

  {% call(item) summary.list_table(
    services,
    caption='Current services',
    field_headings=[
      'Name',
      'Framework',
      'Lot',
      summary.hidden_field_heading("Action")
    ],
    field_headings_visible=True,
    empty_message="You don't have any services on the Digital Marketplace"
  ) %}
    {% call summary.row() %}

      {% if 'EDIT_SERVICE_PAGE' is active_feature %}
        {{ summary.service_link(
            item.serviceName,
            url_for('.edit_service', service_id=item.id)
        ) }}
      {% else %}
        {{ summary.field_name(item.serviceName, wide=True) }}
      {% endif %}

      {{ summary.text(item.frameworkName) }}

      {{ summary.text(item.lotName or item.lot) }}

      {% if item.status == "published" %}
        {{ summary.edit_link("View service", '/g-cloud/services/' + item.id) }}
      {% elif item.status == "disabled" %}
        {% call summary.field(action=True) %}
          <span class="service-status-{{ item.status }}">
            Removed
          </span>
        {% endcall %}
      {% elif item.status == "enabled" %}
        {% call summary.field(action=True) %}
          <span class="service-status-{{ item.status }}">
            Private
          </span>
        {% endcall %}
      {% endif %}

    {% endcall %}
  {% endcall %}
{% endblock %}
