{% from "macros/toolkit_forms.html" import radios %}

{% macro assurance_question(
  name,
  service_data,
  type,
  errors
) %}

  {% set assurance_options = {
    '2answers-type1': [
      {'label': 'Service provider assertion'},
      {'label': 'Independent validation of assertion'}
    ],
    '3answers-type1': [
      {'label': 'Service provider assertion'},
      {'label': 'Contractual commitment'},
      {'label': 'Independent validation of assertion'}
    ],
    '3answers-type2': [
      {'label': 'Service provider assertion'},
      {'label': 'Independent validation of assertion'},
      {'label': 'Independent testing of implementation'}
    ],
    '2answers-type2': [
      {'label': 'Service provider assertion'},
      {'label': 'Independent validation of assertion'},
      {'label': 'Independent testing of implementation'}
    ],
    '3answers-type3': [
      {'label': 'Service provider assertion'},
      {'label': 'Independent testing of implementation'},
      {'label': 'CESG-assured components'}
    ],
    '3answers-type4': [
      {'label': 'Service provider assertion'},
      {'label': 'Independent validation of assertion'},
      {'label': 'Independent testing of implementation'}
    ],
    '4answers-type1': [
      {'label': 'Service provider assertion'},
      {'label': 'Independent validation of assertion'},
      {'label': 'Independent testing of implementation'},
      {'label': 'CESG-assured components'}
    ],
    '4answers-type2': [
      {'label': 'Service provider assertion'},
      {'label': 'Contractual commitment'},
      {'label': 'Independent validation of assertion'},
      {'label': 'CESG-assured components'}
    ],
    '4answers-type3': [
      {'label': 'Service provider assertion'},
      {'label': 'Independent testing of implementation'},
      {'label': 'Assurance of service design'},
      {'label': 'CESG-assured components'}
    ],
    '5answers-type1': [
      {'label': 'Service provider assertion'},
      {'label': 'Contractual commitment'},
      {'label': 'Independent validation of assertion'},
      {'label': 'Independent testing of implementation'},
      {'label': 'CESG-assured components'}
    ]
  } %}

  {{
    radios(
      question_content = {
        'question': 'You may have to provide evidence to back up your answer. Please confirm whether your response is assured by:',
        'id': name + '--assurance',
        'hint': 'Read the government definitions of <a href="https://www.gov.uk/government/publications/implementing-the-cloud-security-principles/implementing-the-cloud-security-principles#independent-validation-of-assertions">independent validation</a>, <a href="https://www.gov.uk/government/publications/implementing-the-cloud-security-principles/implementing-the-cloud-security-principles#independent-testing-of-implementation">independent testing of the implementation</a>, <a href="https://www.gov.uk/government/publications/implementing-the-cloud-security-principles/implementing-the-cloud-security-principles#assurance-in-the-service-components">CESG-assured components</a>, <a href="https://www.gov.uk/government/publications/implementing-the-cloud-security-principles/implementing-the-cloud-security-principles#contractual-commitment">contractual commitment</a> and <a href="https://www.gov.uk/government/publications/implementing-the-cloud-security-principles/implementing-the-cloud-security-principles#service-provider-assertion">service provider assertion</a>.',
        'options': assurance_options[type],
      },
      service_data=service_data,
      errors = errors
    )
  }}

{% endmacro %}
